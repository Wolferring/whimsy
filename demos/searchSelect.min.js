var search={keys:{},values:{},current:-1,init:function(){var e=document.querySelectorAll(".search-group");for(var t=0;t<e.length;t++){var r=e[t].querySelectorAll("select option");var a=document.createElement("input");a.type="text";a.className="search-input";var s=document.createElement("ul");s.className="result-list";e[t].appendChild(a);e[t].appendChild(s);e[t].setAttribute("data-id","search"+t);search.values["search"+t]=[];search.keys["search"+t]=[];for(var n=0;n<r.length;n++){search.values["search"+t].push(r[n].textContent);search.keys["search"+t].push(r[n].value)}}this.listnerBinder()},listnerBinder:function(){var e;var t=document.querySelectorAll(".search-input");for(var r=0;r<t.length;r++){t[r].addEventListener("input",function(t){clearTimeout(e);var r=this.value;var a=this;e=setTimeout(function(){search.find(r,a.parentNode)},200)});t[r].addEventListener("keyup",function(e){e.preventDefault();var t=this.parentNode.querySelectorAll(".result-list li");var e=e||window.event;if(e.keyCode==40){e.preventDefault();search.removeClass(t[search.current==-1?0:search.current],"active");search.current+=1;search.addClass(t[search.current<t.length?search.current:0],"active");if(search.current==t.length){search.current=0}}if(e.keyCode==38){e.preventDefault();search.removeClass(t[search.current==-1?0:search.current],"active");search.current-=1;if(search.current<0){search.current=t.length-1}search.addClass(t[search.current],"active")}if(e.keyCode==13){var r=this.parentNode.querySelector(".result-list .active");if(r){search.set(r.getAttribute("data-value"),r.textContent,this.parentNode)}}if(e.keyCode==27){this.blur();search.clear(this.parentNode)}});t[r].addEventListener("blur",function(){search.current=-1;var e=this.parentNode;var t=search.values[e.getAttribute("data-id")];var r=this.value;var a=false;for(var s=0;s<t.length;s++){if(t[s]==r){a=true}}if(!a){e.querySelector(".search-input").value="";e.querySelector("select").value=""}setTimeout(function(){search.clear(e)},300)});t[r].addEventListener("focus",function(){if(this.value!=""){return false}search.find("",this.parentNode)})}document.querySelector("body").addEventListener("click",function(e){var e=e||window.event;e.preventDefault();var t=e.target||e.srcElement;if(t.tagName.toLowerCase()=="li"){search.set(t.getAttribute("data-value"),t.textContent,e.target.parentNode.parentNode)}})},find:function(e,t){var e=String(e)||"";var r=t.getAttribute("data-id");var a=search.values[r];var s=search.keys[r];var n=t.querySelector(".result-list");var c="";for(var l=0;l<a.length;l++){if(a[l].indexOf(e)>-1){c+='<li class="result-item" data-value='+s[l]+">"+a[l]+"</li>"}}n.innerHTML=c;n.style.display="block";if(c.length<=0){n.style.display="none"}},clear:function(e){e.querySelector(".result-list").style.display="none"},set:function(e,t,r){r.querySelector(".search-input").value=t;var a=r.querySelector("select");for(var s=0;s<a.options.length;s++){if(a.options[s].value==e){a.options[s].selected=true;break}}this.clear(r);search.current=-1},hasClass:function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(e,t){if(!this.hasClass(e,t))e.className+=" "+t},removeClass:function(e,t){if(this.hasClass(e,t)){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ")}}};